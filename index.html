<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simplism簡單保養 - 新人限定轉盤抽獎</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
    body { font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, sans-serif; }
    
    @keyframes float {
      0%,100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(180deg); }
    }
    .animate-float { animation: float 6s ease-in-out infinite; }

    @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    .animate-slide-up { animation: slideUp 0.6s ease; }

    .text-shadow { text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-blue-100 min-h-screen flex items-center justify-center p-4 relative overflow-hidden">

  <!-- 浮動背景 -->
  <div class="fixed top-0 left-0 w-full h-full pointer-events-none z-0">
    <div class="absolute rounded-full opacity-10 w-20 h-20 bg-gradient-to-r from-blue-300 to-blue-400 top-[10%] left-[10%] animate-float" style="animation-delay:0s;"></div>
    <div class="absolute rounded-full opacity-10 w-16 h-16 bg-gradient-to-r from-sky-300 to-cyan-300 top-[20%] right-[15%] animate-float" style="animation-delay:2s;"></div>
    <div class="absolute rounded-full opacity-10 w-24 h-24 bg-gradient-to-r from-blue-400 to-indigo-400 bottom-[15%] left-[20%] animate-float" style="animation-delay:4s;"></div>
  </div>

  <!-- 轉盤容器 -->
  <div class="max-w-xl w-full bg-white/95 rounded-3xl shadow-2xl shadow-blue-200 p-6 sm:p-10 text-center relative z-10 backdrop-blur-sm border-2 border-blue-200/30">

    <h1 class="text-3xl sm:text-4xl font-extrabold bg-gradient-to-r from-slate-600 to-slate-800 bg-clip-text text-transparent mb-2 tracking-wide">Simplism簡單保養</h1>
    <p class="inline-block text-lg md:text-xl text-slate-600 mt-4 mb-12 font-semibold bg-[#ECF5FC] px-8 py-2 rounded-full shadow-md">
      新客限定｜轉出你的專屬優惠
    </p>

    <!-- 轉盤 -->
    <div class="relative w-72 h-72 sm:w-80 sm:h-80 mx-auto mb-6">
      <div id="wheel" class="absolute inset-0 rounded-full bg-gradient-to-b from-slate-300 to-slate-400 p-1.5 shadow-lg shadow-slate-500/30 transition-transform duration-[4000ms] ease-[cubic-bezier(0.23,1,0.32,1)] origin-center"></div>
      <!-- 指針 -->
      <div class="absolute w-0 h-0 top-[-20px] left-1/2 -translate-x-1/2 border-l-[20px] border-r-[20px] border-t-[35px] border-l-transparent border-r-transparent border-t-slate-400 z-20 drop-shadow-lg"></div>
    </div>

    <!-- 馬上領取按鈕 -->
    <div class="w-full flex justify-center mt-4">
      <button
        id="startSpinButton"
        class="w-full max-w-xs bg-gradient-to-r from-slate-600 to-slate-800 text-white font-bold text-xl py-4 px-8 rounded-full shadow-lg shadow-slate-500/40 transition-all duration-300 hover:-translate-y-1"
      >
        馬上領取新客專屬好康！
      </button>
    </div>

    <!-- 抽獎結果 -->
    <div id="resultContainer" class="mt-6 hidden"></div>

  </div>

  <script>
    const PRIZES = [
      { name: '現折<br>30元', code: 'NEW30T', probability: 15, sectionIndex:0, gradient:'linear-gradient(135deg, #D3E5F2 0%, #A4C9E8 100%)' },
      { name: '現折<br>50元', code: 'NEW50F', probability: 25, sectionIndex:1, gradient:'linear-gradient(135deg, #B9D7EA 0%, #769FCD 100%)' },
      { name: '現折<br>80元', code: 'NEW80E', probability: 30, sectionIndex:2, gradient:'linear-gradient(135deg, #A4C9E8 0%, #6892C3 100%)' },
      { name: '現折<br>100元', code: 'NEW100H', probability: 20, sectionIndex:3, gradient:'linear-gradient(135deg, #B9D7EA 0%, #769FCD 100%)' },
      { name: '角質調理露<br>20ml', code: 'NEW20AC', probability: 10, sectionIndex:4, gradient:'linear-gradient(135deg, #D3E5F2 0%, #A4C9E8 100%)' }
    ];

    const wheel = document.getElementById('wheel');
    const resultContainer = document.getElementById('resultContainer');

    // 產生扇區
    PRIZES.forEach((prize,i)=>{
      const div = document.createElement('div');
      div.style.transform = `rotate(${i*72}deg)`;
      div.style.background = prize.gradient;
      div.className = 'absolute w-1/2 h-1/2 origin-bottom-right flex items-center justify-center font-bold text-xs sm:text-sm text-white text-shadow p-4 box-border border-r-2 border-b-2 border-white/40';
      div.innerHTML = `<div class="transform -rotate-45 text-center leading-tight">${prize.name}</div>`;
      wheel.appendChild(div);
    });

    let isSpinning = false;
    let spunPrize = null;

    // 檢查 localStorage
    const savedResult = localStorage.getItem('simplism_lottery_result');
    if(savedResult){
      spunPrize = JSON.parse(savedResult);
      showResult(spunPrize);
    }

    // 轉盤事件
    document.getElementById('startSpinButton').addEventListener('click', ()=>{
      if(isSpinning || spunPrize) return;
      isSpinning = true;

      // 選獎
      const random = Math.random()*100;
      let cumulative = 0;
      let selectedPrize = PRIZES[0];
      for(const prize of PRIZES){
        cumulative += prize.probability;
        if(random<=cumulative){ selectedPrize=prize; break; }
      }

      // 旋轉計算
      const sectionAngle = 72;
      const baseVisualAngle = 225;
      const targetAngle = baseVisualAngle + selectedPrize.sectionIndex * sectionAngle;
      const pointerAngle = 270;
      const rotationToTarget = (pointerAngle - targetAngle + 360)%360;
      const baseRotation = 2160; // 6圈
      const jitter = Math.random()*10-5;
      const finalRotation = baseRotation + rotationToTarget + jitter;

      wheel.style.transform = `rotate(${finalRotation}deg)`;

      setTimeout(()=>{
        spunPrize = selectedPrize;
        isSpinning = false;
        localStorage.setItem('simplism_lottery_result', JSON.stringify(selectedPrize));
        showResult(selectedPrize);
      }, 4000);
    });

    // 顯示結果
    function showResult(prize){
      resultContainer.innerHTML = `
        <div class="mt-6 p-6 bg-[#6380A6] rounded-2xl text-white shadow-lg shadow-blue-500/40 border-2 border-white/50 animate-slide-up text-center">
          <h2 class="text-xl font-bold mb-3">恭喜獲得 ${prize.name}！</h2>
          <div class="relative">
            <div id="copyCode" class="text-2xl font-black bg-white/25 py-3 px-6 rounded-lg my-3 tracking-widest cursor-pointer transition-all duration-300 hover:bg-white/40 hover:scale-105 border-2 border-white/50">${prize.code}</div>
            <div id="copySuccess" class="absolute -top-8 left-1/2 -translate-x-1/2 bg-green-500 text-white text-xs font-semibold px-3 py-1 rounded-md" style="display:none;">已複製！</div>
          </div>
          <p class="text-xs opacity-90">點擊文字框即可複製活動字串 (截圖保存以免忘記！)</p>
          <p class="text-sm mt-1 mb-4">請至結帳頁面『活動字串』貼上使用</p>
          <a href="https://www.simplism.com.tw/products/product/" target="_blank" class="inline-block bg-gradient-to-r from-sky-400 to-blue-500 text-white font-bold py-3 px-8 rounded-full shadow-md transition-transform hover:scale-105 hover:-translate-y-0.5">立即前往購物</a>
        </div>
      `;
      resultContainer.classList.remove('hidden');

      document.getElementById('copyCode').addEventListener('click', ()=>{
        navigator.clipboard.writeText(prize.code).then(()=>{
          const tip = document.getElementById('copySuccess');
          tip.style.display='block';
          setTimeout(()=>{ tip.style.display='none'; }, 2000);
        });
      });
    }
  </script>

</body>
</html>
